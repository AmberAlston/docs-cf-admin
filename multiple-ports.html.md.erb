---
title: Configuring Apps to Listen on Multiple Ports
owner: Routing
---

This topic describes how to configure your apps to listen for traffic on multiple ports. 

## <a id="overview"></a> Overview

By default, apps only receive requests on port 8080 for both HTTP and TCP routing. Configuring multiple app ports allows developers to bring workloads onto Cloud Foundry (CF) that listen on ports other than 8080. Here are some example use cases:

* Serving web client requests on one port and offering stats/debug on another
* Using TCP protocols that require multiple ports 
* Running Docker images on CF 

The [Procedure](#procedure) below describes how to use the `apps` and `route_mappings` Cloud Controller API endpoints to update the ports the app is listening on. 

## <a id="prerequisite"></a> Prerequisite

Before following the procedure to configure your app with multiple ports, you must have the following:

* An app pushed to PCF that can listen on multiple ports. 
* **TCP only**: Routes corresponding to each port you want your app to listen on. 
	For example, if you want your app to listen on `example.com` on ports `1234` and `5678`, you must create routes `example.com:1234` and `example.com:5678` with the cf CLI. 

## <a id="procedure"></a> Procedure

To configure your app to receive HTTP or TCP traffic on multiple ports, do the following:

1. Retrieve the GUID of your app:

	```
	cf APP-NAME --guid
	``` 
	Where `APP-NAME` is the name of your app

1. Add ports to your app:

	```
	cf curl /v2/apps/APP-GUID -X PUT -d '{"ports": [PORT1, PORT2, PORT3...]}'. 
	```
	Where:
	* `APP-GUID` is the GUID of your app
	*  `PORT1, PORT2, PORT3...` is a comma-separated list of the ports on which you want your app to receive traffic. 

1. Retrieve the route GUID for the app route that you want to configure to listen on multiple ports:

	```
	cf curl /v2/routes?q=host:APP-NAME
	```
	Where `APP-NAME` is the name of your app

1. Update the route mapping for your app:

	```
	cf curl /v2/route_mappings -X POST -d '{"app_guid": "APP-GUID", "route_guid": "ROUTE-GUID", "app_port": PORT1}'. 
	```
	Where:
	* `APP-GUID` is the GUID of your app
	* `ROUTE-GUID` is the GUID of the route at which the app serves. 
	*  `PORT1` is the port, or one of the ports, that you added in the previous step. 

1. Repeat the previous two steps for each route and port combination that you want your app to listen on. 

## <a id="additional-resources"></a> Additional Resources

Here are additional resources related to configuring multiple app ports:

* For more information about making requests to the Cloud Controller `apps` endpoint, see [Updating an App](https://apidocs.cloudfoundry.org/6.10.0/apps/updating_an_app.html) in the Cloud Controller API documentation. 
* For more information about making requests to the Cloud Controller `route_mappings` endpoint, see [Mapping an App and a Route](https://apidocs.cloudfoundry.org/6.10.0/routes_mapping/mapping_an_app_and_a_route.html). 
* For an example multi-port app, see the [cf-acceptance-tests](https://github.com/cloudfoundry/cf-acceptance-tests/tree/master/assets/multi-port-app) repository
* For a demo procedure written by an open source CF user, see ["Multiple App Ports" Demo on Cloud Foundry](https://gist.github.com/nota-ja/ef56ea0584ae2b37d6d3a535efe2d4ee). 
